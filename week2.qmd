# Week 2 Homework

This homework covers the material from Lectures 3 and 4, and the content from
book Chapter 4. The questions are reproduced almost identically from
[Richard McElreath's original assignment](https://github.com/rmcelreath/stat_rethinking_2023/blob/main/homework/week02.pdf), I did not write them. I only wrote these solutions.

::: {.callout-note appearance="simple" icon=false}

**1.** From the Howell1 dataset, consider only the people younger than 13
years old. Estimate the causal association between age and weight. Assume that
age influences weight through two paths. First, age influences height, and
height influences weight. Second, age directly influences weight through
age-related changes in muscle growth and body proportions.

Draw the DAG that represents these causal relationships. And then write a
generative simulation that takes age as an input and simulates height
and weight, obeying the relationships in the DAG.

:::

OK, I will assume that the first paragraph is just an introduction to the
homework set and the actual task for this question is in the second paragraph.
Here is the DAG for this problem.

```{r}
# Specify the relationships in the DAG
dag <-
	dagitty::dagitty(
		"dag {
			age -> height -> weight
			age -> weight
		}"
	)

# Specify instructions for plotting the DAG, then do that
dagitty::coordinates(dag) <-
	list(
		x = c(age = 1, height = 2, weight = 2),
		y = c(age = 2, height = 3, weight = 1)
	)
plot(dag)
```

Now we can write a generative simulation. First, let's look at the pairwise
correlations so we can get sort of an idea of the data distributions and the
effects we should simulate.

```{r}
#| message: false
library(rethinking)
data(Howell1)
h1 <-
	Howell1 |>
	dplyr::filter(age < 13)

pairs(h1[1:3])
```

Ok, so with that plot in mind we see that ages are discrete from 0 to 13,
height ranges from about 50 units to 150 units, and weight ranges from about
5 units to 35 units. So our generative simulation should stay within those
ranges.

```{r}
# Set the seed so the simulation makes the same numbers every time
set.seed(101)

# This part does the simulation and puts it into a tibble for storage
sim <- tibble::tibble(
	# Just randomly draw an age. In the original data the ages are not
	# 100% even but I think this is fine.
	age = sample(0:13, nrow(h1), replace = TRUE),
	# Height and weight simulations using dag relationships and made up numbers.
	height = rnorm(nrow(h1), 60 + 5 * age, 10),
	weight = rnorm(nrow(h1), 3 + 0.1 * age + 0.2 * height, 1)
)

# Put the columns into the same order for easier comparisons and plot
sim <- sim[, c("height", "weight", "age")]
pairs(sim)
```

I just randomly picked these numbers and fiddled with it a bit until the two
plots looked similar, and I think I was able to get them pretty close for
such a simple simulation. Now I just need to rewatch the lectures and make
sure this kind of simulation is the same as what McElreath is talking about --
I think it is, and I like this simulation, but I want to make sure I am
learning what I am supposed to be learning.

::: {.callout-note appearance="simple" icon=false}

**2.** Use a linear regression to estimate the **total** causal effect of
each year of growth on weight.

:::

::: {.callout-note appearance="simple" icon=false}

**3.** Now suppose the causal association between age and weight might be
different for boys and girls. Use a single linear regression, with a
categorical variable for sex, to estimate the total causal effect of age on
weight separately for boys and girls. How do girls and boys differ? Provide
one or more posterior contrasts as a summary.

:::

::: {.callout-note appearance="simple" icon=false}

**4.** The data in `data(Oxboys)` are growth records for 26 boys measured
over 9 periods. I want you to model their growth. Specifically, model the
increments in growth from one `Occassion` to the next. Each increment is simply
the difference between height in one occasion and height in the previous
occasion. Since none of these boys shrunk during the study, all of the growth
increments are greater than zero. Estimate the posterior distribution of
these increments. Constrain the distribution so it is always positive -- it
should not be possible for the model to think that boys can shrink from year
to year. Finally computer the posterior distribution of the total growth over
all 9 occasions.

:::

<!-- END OF FILE -->
