{
  "hash": "06d62a305bd2555bd6d7d7d6eac186bf",
  "result": {
    "markdown": "# Week 1 Homework\n\nThis homework covers the material from Lectures 1 and 2, and the content from\nbook Chapters 1, 2, and 3. The questions are reproduced almost identically from\n[Richard McElreath's original assignment](https://github.com/rmcelreath/stat_rethinking_2023/blob/main/homework/week01.pdfhttps://github.com/rmcelreath/stat_rethinking_2023/blob/main/homework/week02.pdf), I did not write them. I only wrote these solutions. As of 2023-01-17, I\nbelieve my solutions are consistent with the now-released official solutions\nby McElreath and I do not intend to edit these further.\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**1.** Suppose the globe tossing data (Lecture 2, Chapter 2) had turned out to\nbe 4 water and 11 land. Construct the posterior distribution.\n\n:::\n\nFortunately, I already did a very similar problem in the textbook, so I used\nthe function that I already wrote. This assumes a uniform prior distribution\nfor $p$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglobe_post <- function(w, l) {\n    # Define the grid of points to evaluate\n    p_grid <- seq(from = 0, to = 1, by = 0.01)\n    \n    # Uniform prior on p: f(x) = 1 / (1 - 0) = 1 for all p\n    prior <- rep(1, times = length(p_grid))\n    \n    # Compute the likelihood over the grid given the observed sample\n    likelihood <- dbinom(w, size = w + l, prob = p_grid)\n    \n    # Compute the unstandardized posterior\n    unstd.posterior <- likelihood * prior\n    \n    # Standardize the posterior\n    posterior <- unstd.posterior / sum(unstd.posterior)\n    \n    # Make the plot\n    plot(p_grid, posterior, type = \"b\", xlab = \"P(water)\",\n         ylab = \"Posterior probability\")\n    mtext(paste(length(p_grid), \"points:\", w, \"W,\", l, \"L\"))\n    \n    # Invisibly return posterior density estimate\n    invisible(posterior)\n}\n# Calculate the posterior after assuming there are 4 water observations and\n# 11 land observations\npost <- globe_post(w = 4, l = 11)\n```\n\n::: {.cell-output-display}\n![](week1_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**2.** Using the posterior distribution from **1**, compute the posterior\npredictive distribution for the next 5 tosses of the same globe. I recommend\nyou use the sampling method.\n\n:::\n\nFirst we construct a set of 10000 samples from the posterior distribution. We\nsample from the same grid of $p$ values that we used to calculate the posterior\ndistribution, weighting the likelihood of each value by the calculated\nposterior density.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples <- sample(\n\tx = seq(from = 0, to = 1, by = 0.01),\n\tsize = 1e5,\n\tprob = post,\n\treplace = TRUE\n)\n```\n:::\n\n\nNext we compute the posterior predictive distribution. We draw from the\nlikelihood function (with $n = 5$ to represent the next five samples) using the\nsampled values of $p$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost_pred <- rbinom(10000, size = 5, prob = samples)\nrethinking::simplehist(post_pred)\n```\n\n::: {.cell-output-display}\n![](week1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**3.** Use the posterior predictive distribution from **2** to calculate the\nprobability of 3 or more water samples in the next 5 tosses.\n\n:::\n\nNow that we have the samples from the posterior predictive distribution, this\nprobability is simple to approximate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(post_pred >= 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1805\n```\n:::\n:::\n\n\nThe probability of three or more water samples in the next 5 tosses is\napproximately $18.28\\%$, based on our posterior predictive distribution.\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**4.** Suppose you observe $W = 5$ water points, but you forgot to write down\nhow many times the globe was tossed, so you don't know the number of land\npoints, $L$. Assume that $p = 0.7$ and compute the posterior distribution of\nthe number of tosses $N$.\n\n:::\n\nIf we assume that $p = 0.5$ and we observe $W = 5$ water points, then the\nlikelihood as a function of $N$ (unknown) is\n\n$$P(N) = \\left( N\\atop{5} \\right) 5^{0.7} (N-5)^{0.3}.$$\n\nWe need to choose a prior for $N$ in order to calculate the posterior\ndistribution. We haven't discussed many different distributions for priors yet,\nbut I'll choose a Poisson prior because it has the set $\\{0, 1, \\ldots, \\infty\\}$\nas its support, so there is no upper limit on $N$ that we have to choose.\nThe Poisson distribution has one parameter, called $\\lambda$, I'll choose to\nbe $5$ for no other reason than that is the number of throws we know we\nobserved. It would also make sense to choose a uniform prior with some very\nlarge upper boundary, say $\\mathrm{Uniform}(5, 100)$. (Or even smaller than\nthat, because we can probably place a relatively small upper bound on the\nnumber of times we threw the ball, since we know $p = 0.7$.)\n\nOther than changing the prior, we calculate this the same way. Since it's\nimpossible for us to evaluate every $N$ up to $\\infty$, I'll just calculate\nup to 25 and that should be plenty.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the grid of points to evaluate\nn_grid <- seq(from = 0, to = 25, by = 1)\n# Poisson prior on n\nprior <- dpois(n_grid, lambda = 5)\n# Compute the likelihood over the grid given the observed sample\nlikelihood <- dbinom(5, size = n_grid, prob = 0.7)\n# Compute the unstandardized posterior\nunstd.posterior <- likelihood * prior\n# Standardize the posterior\nposterior <- unstd.posterior / sum(unstd.posterior)\n# Make the plot\nplot(n_grid, posterior, type = \"b\", xlab = \"Number of samples (N)\",\n\t\t ylab = \"Posterior probability\")\nlines(n_grid, prior, type = \"l\", lty = 2)\n```\n\n::: {.cell-output-display}\n![](week1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nIn this figure, the points are the observed posterior probabilities. The solid\nline just connects them to give us a better idea of the shape of the distribution.\nThe dashed line shows the Poisson prior on $N$.\n\nAs we can see in the posterior, **it is impossible that we drew less than 5**\n**samples**. That's good, that means that our model reflects reality,\nwhich is a good sanity check for our golem. Given that $p = 0.7$ however,\nit is actually quite plausible that we only tossed the globe 5 times, which\ncould explain why we didn't write down the number of tosses or the number of\nland throws -- there weren't any.\n\nHowever, the MAP estimate would be that we threw the globe 6 times, with 7\ntimes in a close second place. As we get to 10 or higher, it becomes\nincredibly unlikely that we would throw the ball this many times and *only*\nobserve 5 water tosses.\n\n<!-- END OF FILE -->\n",
    "supporting": [
      "week1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}