{
  "hash": "fc997c9f92b32ca043b98e6c057bba04",
  "result": {
    "markdown": "# Week 2 Homework\n\nThis homework covers the material from Lectures 3 and 4, and the content from\nbook Chapter 4. The questions are reproduced almost identically from\n[Richard McElreath's original assignment](https://github.com/rmcelreath/stat_rethinking_2023/blob/main/homework/week02.pdf), I did not write them. I only wrote these solutions.\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**1.** From the Howell1 dataset, consider only the people younger than 13\nyears old. Estimate the causal association between age and weight. Assume that\nage influences weight through two paths. First, age influences height, and\nheight influences weight. Second, age directly influences weight through\nage-related changes in muscle growth and body proportions.\n\nDraw the DAG that represents these causal relationships. And then write a\ngenerative simulation that takes age as an input and simulates height\nand weight, obeying the relationships in the DAG.\n\n:::\n\nOK, I will assume that the first paragraph is just an introduction to the\nhomework set and the actual task for this question is in the second paragraph.\nHere is the DAG for this problem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify the relationships in the DAG\ndag <-\n\tdagitty::dagitty(\n\t\t\"dag {\n\t\t\tage -> height -> weight\n\t\t\tage -> weight\n\t\t}\"\n\t)\n\n# Specify instructions for plotting the DAG, then do that\ndagitty::coordinates(dag) <-\n\tlist(\n\t\tx = c(age = 1, height = 2, weight = 2),\n\t\ty = c(age = 2, height = 3, weight = 1)\n\t)\nplot(dag)\n```\n\n::: {.cell-output-display}\n![](week2_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nNow we can write a generative simulation. First, let's look at the pairwise\ncorrelations so we can get sort of an idea of the data distributions and the\neffects we should simulate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rethinking)\ndata(Howell1)\nh1 <-\n\tHowell1 |>\n\tdplyr::filter(age < 13)\n\npairs(h1[1:3])\n```\n\n::: {.cell-output-display}\n![](week2_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nOk, so with that plot in mind we see that ages are discrete from 0 to 13,\nheight ranges from about 50 units to 150 units, and weight ranges from about\n5 units to 35 units. So our generative simulation should stay within those\nranges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the seed so the simulation makes the same numbers every time\nset.seed(101)\n\n# This part does the simulation and puts it into a tibble for storage\nsim <- tibble::tibble(\n\t# Just randomly draw an age. In the original data the ages are not\n\t# 100% even but I think this is fine.\n\tage = sample(0:13, nrow(h1), replace = TRUE),\n\t# Height and weight simulations using dag relationships and made up numbers.\n\theight = rnorm(nrow(h1), 60 + 5 * age, 10),\n\tweight = rnorm(nrow(h1), 3 + 0.1 * age + 0.2 * height, 1)\n)\n\n# Put the columns into the same order for easier comparisons and plot\nsim <- sim[, c(\"height\", \"weight\", \"age\")]\npairs(sim)\n```\n\n::: {.cell-output-display}\n![](week2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nI just randomly picked these numbers and fiddled with it a bit until the two\nplots looked similar, and I think I was able to get them pretty close for\nsuch a simple simulation. Now I just need to rewatch the lectures and make\nsure this kind of simulation is the same as what McElreath is talking about --\nI think it is, and I like this simulation, but I want to make sure I am\nlearning what I am supposed to be learning.\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**2.** Use a linear regression to estimate the **total** causal effect of\neach year of growth on weight.\n\n:::\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**3.** Now suppose the causal association between age and weight might be\ndifferent for boys and girls. Use a single linear regression, with a\ncategorical variable for sex, to estimate the total causal effect of age on\nweight separately for boys and girls. How do girls and boys differ? Provide\none or more posterior contrasts as a summary.\n\n:::\n\n::: {.callout-note appearance=\"simple\" icon=false}\n\n**4.** The data in `data(Oxboys)` are growth records for 26 boys measured\nover 9 periods. I want you to model their growth. Specifically, model the\nincrements in growth from one `Occassion` to the next. Each increment is simply\nthe difference between height in one occasion and height in the previous\noccasion. Since none of these boys shrunk during the study, all of the growth\nincrements are greater than zero. Estimate the posterior distribution of\nthese increments. Constrain the distribution so it is always positive -- it\nshould not be possible for the model to think that boys can shrink from year\nto year. Finally computer the posterior distribution of the total growth over\nall 9 occasions.\n\n:::\n\n<!-- END OF FILE -->\n",
    "supporting": [
      "week2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}